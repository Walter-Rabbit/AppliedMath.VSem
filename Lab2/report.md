# Лабораторная работа №2 "Применение симплекс-метода"

## **Задание 1**

## **Задание 2**

| Скорость (т/ч) | 1-ый погрузчик | 2-ой погрузчик |
| --- | --- | --- |
| 1-ая площадка | $10$ | $13$ |
| 2-ая площадка | $12$ | $13$ |

| Стоимость (р/т) | 1-ый погрузчик | 2-ой погрузчик |
| --- | --- | --- |
| 1-ая площадка | $8$ | $12$ |
| 2-ая площадка | $7$ | $13$ |

| Цель (т) | |
| --- | --- |
| 1-ая площадка | $230$ |
| 2-ая площадка | $68$ |

Сформулируем задача линейного программирования.

Обозначим времена проведённые на площадках погрузчиками следующим образом:

* $x_1$ - время проведённое первым погрузчиком на первой площадке.
* $x_2$ - время проведённое первым погрузчиком на второй площадке.
* $x_3$ - время проведённое вторым погрузчиком на первой площадке.
* $x_4$ - время проведённое вторым погрузчиком на второй площадке.

Результирующая функция - функция стоимости, её нужно минимизировать. Она представляет собой сумму времён, умноженных на
скорость и на стоимость:

* $F(\overline x ) = x_1 \cdot 10 \cdot 8 + x_2 \cdot 12 \cdot 7 + x_3 \cdot 13 \cdot 12 + x_4 \cdot 13 \cdot 13$

Зададим ограничения:

* $x_1 + x_2 \le 24$ - общее время работы первого погрузчика не должно превыщать 24 часа.
* $x_3 + x_4 \le 24$ - общее время работы второго погрузчика не должно превыщать 24 часа.
* $x_1 \cdot 10 + x_3 \cdot 13 = 230$ - первый погрузчик должен погрузить ровно 230 тонн.
* $x_2 \cdot 12 + x_4 \cdot 13 = 68$ - второй погрузчик должен погрузить ровно 68 тонн.

Задача линейного программирования сформулирована, введём в программу, которую мы написали для первой лабораторной работы
эту задачу.

Ввод для программы:

```json
{
  "Equations": [
    {
      "Coefficients": [10.0, 0.0, 13.0, 0.0],
      "FreeElement": 230.0
    },
    {
      "Coefficients": [0.0, 12.0, 0.0, 13.0],
      "FreeElement": 68.0
    }
  ],
  "Inequalities": [
    {
      "Coefficients": [1.0, 1.0, 0.0, 0.0],
      "FreeElement": 24.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [0.0, 0.0, 1.0, 1.0],
      "FreeElement": 24.0,
      "Term": "LowerEqual"
    }
  ],
  "Function": {
    "Coefficients": [80.0, 84.0, 156.0, 169.0]
  },
  "Mode": "Minimize"
}
```

Полученный вывод:

```json
{
  "X": [18.333333333333336, 5.666666666666665, 3.589743589743588, 0.0, 0.0, 20.410256410256412],
  "FunctionValue": 2502.6666666666665
}
```

Получается, что самое лучшее распределение погрузчиков следующее:

* 1-ый погрузчик работает $18.334$ часов на 1-ой площадке, а потом $5.667$ часов (оставшееся время) на 2-ой площадке.
* 2-ой погрузчик работает только на 1-ой площадке $3.590$ часа.

Затраты на такое распределение - $2502.667$ рублей.

## **Задание 3**

## **Задание 4**

## **Задание 5**

## **Задание 6**

Дана матрица проигрышей первого игрока:

$$
\left(
  \begin{array}{}
    7 \quad 2 \quad 5 \quad 1 \\
    2 \quad 2 \quad 3 \quad 4 \\
    5 \quad 3 \quad 4 \quad 4 \\
    3 \quad 2 \quad 1 \quad 6
  \end{array}
\right)
$$

Приведём решение к решению задачи линейного программирования. Прямая задача даст стратегию для первого игрока (учтём, что он минимизирует проигрыш), а двойственная даст стратегию для второго игрока.

Прямая задача линейного программирования:

$$
x_1 + x_2 + x_3 + x_4 \rightarrow min
$$

$$
\begin{cases}
7x_1 + 2x_2 + 5x_3 + 1x_4 \ge 1 \\
2x_1 + 2x_2 + 3x_3 + 4x_4 \ge 1 \\
5x_1 + 3x_2 + 4x_3 + 4x_4 \ge 1 \\
3x_1 + 2x_2 + 1x_3 + 6x_4 \ge 1 \\
x_j \ge 0, \quad (j = 1, 2, 3, 4)
\end{cases}
$$

Воспользуемся симлекс методом, который мы написали для выполнения первой лабораторной работы.

Ввод для программы:

```json
{
  "Equations": [],
  "Inequalities": [
    {
      "Coefficients": [7.0, 2.0, 5.0, 1.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [2.0, 2.0, 3.0, 4.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [5.0, 3.0, 4.0, 4.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [3.0, 2.0, 1.0, 6.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    }
  ],
  "Function": {
    "Coefficients": [1.0, 1.0, 1.0, 1.0]
  },
  "Mode": "Minimize"
}
```

Вывод программы:

```json
{
  "X": [0.02197802197802197, 0.0, 0.14285714285714285, 0.1318681318681319, 0.0, 0.20879120879120866, 0.0, 0.0],
  "FunctionValue": 0.2967032967032967
}
```

**Цена игры равна** обратному значению полилинейной формы - это примерно равно $\bold{3.370}$. А **оптимальная смешанная стратегия для первого игрока** - произведение цены игры на вектор решения прямой задачи, то есть $\bold{(0.074, 0, 0.481, 0.444)}$.

Теперь составим двойственную задачу и также решим её с помощью нашей программы:

$$
y_1 + y_2 + y_3 + y_4 \rightarrow max
$$

$$
\begin{cases}
7y_1 + 2y_2 + 5y_3 + 3y_4 \le 1 \\
2y_1 + 2y_2 + 3y_3 + 2y_4 \le 1 \\
5y_1 + 3y_2 + 4y_3 + 1y_4 \le 1 \\
1y_1 + 4y_2 + 4y_3 + 6y_4 \le 1 \\
y_j \ge 0, \quad (j = 1, 2, 3, 4)
\end{cases}
$$

Ввод для программы:

```json
{
  "Equations": [],
  "Inequalities": [
    {
      "Coefficients": [7.0, 2.0, 5.0, 3.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [2.0, 2.0, 3.0, 2.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [5.0, 3.0, 4.0, 1.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [1.0, 4.0, 4.0, 6.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    }
  ],
  "Function": {
    "Coefficients": [1.0, 1.0, 1.0, 1.0]
  },
  "Mode": "Maximize"
}
```

Вывод для программы:

```json
{
  "X": [0.07692307692307691, 0.19780219780219782, 0.0, 0.021978021978021976, 0.0, 0.0, 0.4065934065934066, 0.0],
  "FunctionValue": 0.2967032967032967
}
```

**Цена игры** остаётся прежней, то есть $\bold{3.370}$. А **оптимальная смешанная стратегия второго игрока равна $\bold{(0.259, 0,667, 0, 0.074)}$.**

Математическое ожидание проигрыша первого игрока в данном случае равно произведению оптимальной стратегии первого игрока на матрицу игры и на транспонированную оптимальную стратегию второго игрока.

$$
\left(
  \begin{array}{}
    0.074 \quad 0 \quad 0.481 \quad 0.444
  \end{array}
\right)
\cdot
\left(
  \begin{array}{}
    7 \quad 2 \quad 5 \quad 1 \\
    2 \quad 2 \quad 3 \quad 4 \\
    5 \quad 3 \quad 4 \quad 4 \\
    3 \quad 2 \quad 1 \quad 6
  \end{array}
\right)
\cdot
\left(
  \begin{array}{}
    0.259 \\
    0,667 \\
    0 \\
    0.074
  \end{array}
\right) =
\frac{1550263}{500000}
$$

**Математическое ожидание проигрыша первого игрока равно $\bold{3.101}$.**

## **Задание 7**

## **Задание 8**

## **Задание 9**
