# Лабораторная работа №2 "Применение симплекс-метода"

## **Задание 1**

### Условие задачи

Где строить? Две конкурирующие крупные торговые фирмы F1 и F2, планируют построить в одном из четырёх небольших городов G1, G2, G3, G4, лежащих вдоль автомагистрали, по одному универсаму. Взаимное расположение городов, расстояние между ними и численность населения показаны на следующей схеме:

|                   |         |         |         |         |
| ----------------- | ------- | ------- | ------- | ------- |
| 140 км            | 30 км   | 40 км   | 50 км   | 150 км  |
|                   | G1      | G2      | G3      | G4      |
| Число покупателей | 30 тыс. | 50 тыс. | 40 тыс. | 30 тыс. |

Доход, получаемый каждой фирмой, определяется численностью населения городов, а также степенью удалённости универсамов от места жительства потенциальных покупателей. Специально проведённое исследование показало, что доход универсамов будет распределяться между фирмами так, как это показано в следующей таблице

| Условия                                                              | F1  | F2  |
| -------------------------------------------------------------------- | --- | --- |
| Универсам фирмы F1 расположен от города ближе универсама фирмы F2    | 75% | 25% |
| Универсамы обеих фирм расположены на одинаковом расстоянии от города | 60% | 40% |
| Универсам фирмы F1 расположен от города дальше универсама фирмы F2   | 45% | 55% |

Например, если универсам фирмы F1 расположен от города G1 ближе универсама фирмы F2, то доход от фирм от покупок, сделанных жителями данного города, распределится следующим образом - 75% получит F1, остальное - F2.

1. Представьте описанную ситуацию, как игру двух лиц
2. В каких городах фирмам целесообразно построить свои универсамы

### Решение

Если представить данную ситуацию как игру двух лиц, то каждому из двух игроков нужно выбрать один из четырёх вариантов так, чтобы получить максимально возможную прибыль. Будем считать прибыль от каждого человека равной 1 (То есть город из 10000 может приносит прибыть 10000).

Построим таблицу, отображающая доход каждой фирмы в зависимости от города, в котором они расположат свой универмаг

<table class="waffle" cellspacing="0" cellpadding="0"><tbody><tr style="height: 20px"><td class="s0" dir="ltr">F1 \ F2</td><td class="s0" dir="ltr">G1</td><td class="s0" dir="ltr">G2</td><td class="s0" dir="ltr">G3</td><td class="s0" dir="ltr">G4</td><td class="s1"></td></tr><tr style="height: 20px"><td class="s2" dir="ltr" rowspan="2">G1</td><td class="s3" dir="ltr">90000</td><td class="s3" dir="ltr">76500</td><td class="s3" dir="ltr">84000</td><td class="s3" dir="ltr">103500</td><td class="s1" dir="ltr">F1</td></tr><tr style="height: 20px"><td class="s4" dir="ltr">60000</td><td class="s4" dir="ltr">73500</td><td class="s4" dir="ltr">66000</td><td class="s4" dir="ltr">46500</td><td class="s1" dir="ltr">F2</td></tr><tr style="height: 20px"><td class="s2" dir="ltr" rowspan="2">G2</td><td class="s3">103500</td><td class="s3" dir="ltr">90000</td><td class="s3" dir="ltr">91500</td><td class="s3" dir="ltr">103500</td><td class="s1" dir="ltr">F1</td></tr><tr style="height: 20px"><td class="s4">46500</td><td class="s4" dir="ltr">60000</td><td class="s4" dir="ltr">58500</td><td class="s4" dir="ltr">46500</td><td class="s1" dir="ltr">F2</td></tr><tr style="height: 20px"><td class="s2" dir="ltr" rowspan="2">G3</td><td class="s3">96000</td><td class="s3" dir="ltr">88500</td><td class="s3" dir="ltr">90000</td><td class="s3" dir="ltr">103500</td><td class="s1" dir="ltr">F1</td></tr><tr style="height: 20px"><td class="s4">54000</td><td class="s4" dir="ltr">61500</td><td class="s4" dir="ltr">60000</td><td class="s4" dir="ltr">46500</td><td class="s1" dir="ltr">F2</td></tr><tr style="height: 20px"><td class="s2" dir="ltr" rowspan="2">G4</td><td class="s3" dir="ltr">76500</td><td class="s3" dir="ltr">76500</td><td class="s3" dir="ltr">76500</td><td class="s3" dir="ltr">90000</td><td class="s1" dir="ltr">F1</td></tr><tr style="height: 20px"><td class="s4">73500</td><td class="s4">73500</td><td class="s4">73500</td><td class="s4" dir="ltr">60000</td><td class="s5" dir="ltr">F2</td></tr></tbody></table>

Общая возможная прибыль универмагов ограничена (150000), так что чем больше прибыль универмага F1, тем меньше прибыть универмага F2. Из таблицы видно, что прибыль универмага F1 всегда больше чем прибыль универмага F2. Построим ещё одну таблицу, отображающую разницу между прибылью универмага F1 и F2

> Эту разницу можно воспринимать как убытки F2, то есть им выгодно минимизировать её т.к. суммарная прибыль двух фирм всегда одинаковая

| F1 / F2 | G1    | G2    | G3    | G4    |
| ------- | ----- | ----- | ----- | ----- |
| G1      | 30000 | 3000  | 18000 | 57000 |
| G2      | 57000 | 30000 | 33000 | 57000 |
| G3      | 42000 | 27000 | 30000 | 57000 |
| G4      | 3000  | 3000  | 3000  | 30000 |

Применим алгоритм минмакс (и максмин) для определения наиболее оптимального для построения универмага места.

**F1**

Посмотрим на минимальную гарантированную прибыль в каждом городе

| G1 | G2 | G3 | G4 |
| -- | -- | -- | -- |
| 3000 | 30000 | 27000 | 3000 |

Из них выбираем максимальную - город G2.

**F2**

Посмотрим на максимально возможные "убытки" в каждом городе

| G1 | G2 | G3 | G4 |
| -- | -- | -- | -- |
| 57000 | 30000 | 33000 | 57000 |

Из них выбираем минимальный - город G2

**Итог** 

Самой оптимальной стратегией для каждой из фирм будет построить универмаг в городе G2

## **Задание 2**

| Скорость (т/ч) | 1-ый погрузчик | 2-ой погрузчик |
| --- | --- | --- |
| 1-ая площадка | $10$ | $13$ |
| 2-ая площадка | $12$ | $13$ |

| Стоимость (р/т) | 1-ый погрузчик | 2-ой погрузчик |
| --- | --- | --- |
| 1-ая площадка | $8$ | $12$ |
| 2-ая площадка | $7$ | $13$ |

| Цель (т) | |
| --- | --- |
| 1-ая площадка | $230$ |
| 2-ая площадка | $68$ |

Сформулируем задача линейного программирования.

Обозначим времена проведённые на площадках погрузчиками следующим образом:

* $x_1$ - время проведённое первым погрузчиком на первой площадке.
* $x_2$ - время проведённое первым погрузчиком на второй площадке.
* $x_3$ - время проведённое вторым погрузчиком на первой площадке.
* $x_4$ - время проведённое вторым погрузчиком на второй площадке.

Результирующая функция - функция стоимости, её нужно минимизировать. Она представляет собой сумму времён, умноженных на
скорость и на стоимость:

* $F(\overline x ) = x_1 \cdot 10 \cdot 8 + x_2 \cdot 12 \cdot 7 + x_3 \cdot 13 \cdot 12 + x_4 \cdot 13 \cdot 13$

Зададим ограничения:

* $x_1 + x_2 \le 24$ - общее время работы первого погрузчика не должно превыщать 24 часа.
* $x_3 + x_4 \le 24$ - общее время работы второго погрузчика не должно превыщать 24 часа.
* $x_1 \cdot 10 + x_3 \cdot 13 = 230$ - первый погрузчик должен погрузить ровно 230 тонн.
* $x_2 \cdot 12 + x_4 \cdot 13 = 68$ - второй погрузчик должен погрузить ровно 68 тонн.

Задача линейного программирования сформулирована, введём в программу, которую мы написали для первой лабораторной работы
эту задачу.

Ввод для программы:

```json
{
  "Equations": [
    {
      "Coefficients": [10.0, 0.0, 13.0, 0.0],
      "FreeElement": 230.0
    },
    {
      "Coefficients": [0.0, 12.0, 0.0, 13.0],
      "FreeElement": 68.0
    }
  ],
  "Inequalities": [
    {
      "Coefficients": [1.0, 1.0, 0.0, 0.0],
      "FreeElement": 24.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [0.0, 0.0, 1.0, 1.0],
      "FreeElement": 24.0,
      "Term": "LowerEqual"
    }
  ],
  "Function": {
    "Coefficients": [80.0, 84.0, 156.0, 169.0]
  },
  "Mode": "Minimize"
}
```

Полученный вывод:

```json
{
  "X": [18.333333333333336, 5.666666666666665, 3.589743589743588, 0.0, 0.0, 20.410256410256412],
  "FunctionValue": 2502.6666666666665
}
```

Получается, что самое лучшее распределение погрузчиков следующее:

* 1-ый погрузчик работает $18.334$ часов на 1-ой площадке, а потом $5.667$ часов (оставшееся время) на 2-ой площадке.
* 2-ой погрузчик работает только на 1-ой площадке $3.590$ часа.

Затраты на такое распределение - $2502.667$ рублей.

## **Задание 3**

### Условие

При составлении суточного рациона кормления скота используют сено и силос. Рацион должен обладать определённой питательностью и содержать белка не менее 1 кг, кальция не менее 100 г и фосфора не менее 80 г. При этом количество питательного рациона должно быть не менее 60 кг. Содержание питательных компонентов в 1 кг сена и силоса приведено в следующей таблице. В ней указана также стоимость единицы того или иного корма. Требуется определить оптимальный суточный рацион кормления животных, обеспечивающий минимальную стоимость корма.

| Название  | Норма (г) | Содержание в сене | Содержание в силосе |
| --------- | --------- | ----------------- | ------------------- |
| Белок     | 1000      | 40                | 10                  |
| Кальций   | 100       | 1.25              | 2.5                 |
| Фосфор    | 80        | 2                 | 1                   |
| Стоимость |           | 12                | 8                   |

### Решение

Сформулируем задачу линейного программирования. Введём обозначения

$x_1$ - количество сена (в кг) в дневном рационе
$x_2$ - количество силоса (в кг) в дневном рационе

Тогда функция стоимости будет иметь вид

$F(x)=12x_1+8x_2$

Систему ограничений представим в следующем виде

$$
\begin{cases}
x_1+x_2 \geq 60 \\
0.04x_1+0.01x_2 \geq 1 \\
0.00125x_1+0.0025x_2 \geq 0.1 \\
0.002x_1+0.001x_2 \geq 0.08
\end{cases}
$$

Задача линейного программирования сформулирована, введём в программу, которую мы написали для первой лабораторной работы
эту задачу.

Ввод для программы:

```json
{
  "Equations": [
  ],
  "Inequalities": [
    {
      "Coefficients": [
        1.0,
        1.0
      ],
      "FreeElement": 60.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [
        0.04,
        0.01
      ],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [
        0.00125,
        0.0025
      ],
      "FreeElement": 0.1,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [
        0.002,
        0.001
      ],
      "FreeElement": 0.08,
      "Term": "GreaterEqual"
    }
  ],
  "Function": {
    "Coefficients": [
      12,
      8
    ]
  },
  "Mode": "Minimize"
}
```

Вывод

```json
{"X":[20.000000000000007,39.99999999999999,0.0,0.0,0.02499999999999998,0.0],"FunctionValue":560.0}
```

Получается лучший дневной рацион следующий:
* 20 килограмм сена
* 40 килограмм силоса

Цена такого рациона - 560 ден.ед.

## **Задание 4**

Матрица проигрышей первого игрока:

$$
\left(
  \begin{array}{}
    4 & 2 \\
    2 & 3
  \end{array}
\right)
$$

Решив задачу линейного программирования, полученную из этой матрицы, мы получим оптимальную стратегию первого игрока. Учтём, что он минимизирует свой проигрыш.

Задача линейного программирования:

$$
x_1 + x_2 \rightarrow min
$$

$$
\begin{cases}
  4x_1 + 2x_2 \ge 1 \\
  2x_1 + 3x_2 \ge 1 \\
  x_j \ge 0, \quad j = 1, 2
\end{cases}
$$

Ввод для программы:

```json
{
  "Equations": [],
  "Inequalities": [
    {
      "Coefficients": [4.0, 2.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [2.0, 3.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    }
  ],
  "Function": {
    "Coefficients": [1.0, 1.0]
  },
  "Mode": "Minimize"
}
```

Вывод программы:

```json
{
  "X": [0.125, 0.25, 0.0, 0.0],
  "FunctionValue": 0.375
}
```

Цену игры можно найти, как обратное значение полилинейной формы - $\frac{1}{0.375}$. То есть **цена игры равна $\bold{\frac{8}{3}}$.**

А оптимальную смешанную стратегию можно найти, как произведение цены игры на вектор решения задачи - $\frac{8}{3} \cdot (0.125, 0.25)$. Таким образом **оптимальная смешанная стратегия для первого игрока - $\bold{(\frac{1}{3}, \frac{2}{3})}$.**

## **Задание 5**

### Условие 

Пусть матрица проигрышей (в млн руб.) первого игрока имеет вид

$$
\left(
\begin{array}{}
  8 & 4 & 6 \\
  4 & 8 & 5
\end{array}
\right)
$$

Решить матричную игру, перейдя к задаче линейного программирования. Найти оптимальную смешанную стратегию для первого игрока (использовать симплекс-метод).

### Решение

Так как дана матрица проигрышей, нужно минимизировать убытки первого игрока.

$$
x_1 + x_2 + x_3 \rightarrow \min
$$

$$
\begin{cases}
  8x_1 + 4x_2 + 6x_3 \geq 1 \\
  4x_1 + 8x_2 + 5x_3 \geq 1 \\
  x_j \ge 0, \quad j=1, 2, 3
\end{cases}
$$

Ввод для программы:

```json
{
  "Equations": [],
  "Inequalities": [
    {
      "Coefficients" : [8.0, 4.0, 6.0],
      "FreeElement" : 1.0,
      "Term" : "GreaterEqual"
    },
    {
      "Coefficients" : [4.0, 8.0, 5.0],
      "FreeElement" : 1.0,
      "Term" : "GreaterEqual"
    }
  ],
  "Function": {
    "Coefficients": [1.0, 1.0, 1.0]
  },
  "Mode": "Minimize"
}
```

Вывод программы:

```json
{
  "X": [0.08333333333333334,0.08333333333333333,0.0,0.0,0.0],
  "FunctionValue" : 0.16666666666666669
}
```

Цену игры можно найти, как обратное значение полилинейной формы: $\frac{1}{0.16666666666666669} = 6$. То есть **цена игры равна 6 млн. руб.**

Оптимальную смешанную стратегию можно найти как произведение цены на верктор решения задачи - $6 \cdot (\frac{1}{12}, \frac{1}{12})$. Таким образом **оптимальная смешанная стратегия для первого игрока - $(\frac{1}{2}, \frac{1}{2})$**

## **Задание 6**

Дана матрица проигрышей первого игрока:

$$
\left(
  \begin{array}{}
    7 \quad 2 \quad 5 \quad 1 \\
    2 \quad 2 \quad 3 \quad 4 \\
    5 \quad 3 \quad 4 \quad 4 \\
    3 \quad 2 \quad 1 \quad 6
  \end{array}
\right)
$$

Приведём решение к решению задачи линейного программирования. Прямая задача даст стратегию для первого игрока (учтём, что он минимизирует проигрыш), а двойственная даст стратегию для второго игрока.

Прямая задача линейного программирования:

$$
x_1 + x_2 + x_3 + x_4 \rightarrow min
$$

$$
\begin{cases}
7x_1 + 2x_2 + 5x_3 + 1x_4 \ge 1 \\
2x_1 + 2x_2 + 3x_3 + 4x_4 \ge 1 \\
5x_1 + 3x_2 + 4x_3 + 4x_4 \ge 1 \\
3x_1 + 2x_2 + 1x_3 + 6x_4 \ge 1 \\
x_j \ge 0, \quad (j = 1, 2, 3, 4)
\end{cases}
$$

Воспользуемся симлекс методом, который мы написали для выполнения первой лабораторной работы.

Ввод для программы:

```json
{
  "Equations": [],
  "Inequalities": [
    {
      "Coefficients": [7.0, 2.0, 5.0, 1.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [2.0, 2.0, 3.0, 4.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [5.0, 3.0, 4.0, 4.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    },
    {
      "Coefficients": [3.0, 2.0, 1.0, 6.0],
      "FreeElement": 1.0,
      "Term": "GreaterEqual"
    }
  ],
  "Function": {
    "Coefficients": [1.0, 1.0, 1.0, 1.0]
  },
  "Mode": "Minimize"
}
```

Вывод программы:

```json
{
  "X": [0.02197802197802197, 0.0, 0.14285714285714285, 0.1318681318681319, 0.0, 0.20879120879120866, 0.0, 0.0],
  "FunctionValue": 0.2967032967032967
}
```

**Цена игры равна** обратному значению полилинейной формы - это примерно равно $\bold{3.370}$. А **оптимальная смешанная стратегия для первого игрока** - произведение цены игры на вектор решения прямой задачи, то есть $\bold{(0.074, 0, 0.481, 0.444)}$.

Теперь составим двойственную задачу и также решим её с помощью нашей программы:

$$
y_1 + y_2 + y_3 + y_4 \rightarrow max
$$

$$
\begin{cases}
7y_1 + 2y_2 + 5y_3 + 3y_4 \le 1 \\
2y_1 + 2y_2 + 3y_3 + 2y_4 \le 1 \\
5y_1 + 3y_2 + 4y_3 + 1y_4 \le 1 \\
1y_1 + 4y_2 + 4y_3 + 6y_4 \le 1 \\
y_j \ge 0, \quad (j = 1, 2, 3, 4)
\end{cases}
$$

Ввод для программы:

```json
{
  "Equations": [],
  "Inequalities": [
    {
      "Coefficients": [7.0, 2.0, 5.0, 3.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [2.0, 2.0, 3.0, 2.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [5.0, 3.0, 4.0, 1.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    },
    {
      "Coefficients": [1.0, 4.0, 4.0, 6.0],
      "FreeElement": 1.0,
      "Term": "LowerEqual"
    }
  ],
  "Function": {
    "Coefficients": [1.0, 1.0, 1.0, 1.0]
  },
  "Mode": "Maximize"
}
```

Вывод для программы:

```json
{
  "X": [0.07692307692307691, 0.19780219780219782, 0.0, 0.021978021978021976, 0.0, 0.0, 0.4065934065934066, 0.0],
  "FunctionValue": 0.2967032967032967
}
```

**Цена игры** остаётся прежней, то есть $\bold{3.370}$. А **оптимальная смешанная стратегия второго игрока равна $\bold{(0.259, 0,667, 0, 0.074)}$.**

Математическое ожидание проигрыша первого игрока в данном случае равно произведению оптимальной стратегии первого игрока на матрицу игры и на транспонированную оптимальную стратегию второго игрока.

$$
\left(
  \begin{array}{}
    0.074 \quad 0 \quad 0.481 \quad 0.444
  \end{array}
\right)
\cdot
\left(
  \begin{array}{}
    7 \quad 2 \quad 5 \quad 1 \\
    2 \quad 2 \quad 3 \quad 4 \\
    5 \quad 3 \quad 4 \quad 4 \\
    3 \quad 2 \quad 1 \quad 6
  \end{array}
\right)
\cdot
\left(
  \begin{array}{}
    0.259 \\
    0,667 \\
    0 \\
    0.074
  \end{array}
\right) =
\frac{1550263}{500000}
$$

**Математическое ожидание проигрыша первого игрока равно $\bold{3.101}$.**

## **Задание 7**

### Условие

Платёжная матрица в некоторой игре имеет вид

$$
\left(
\begin{array}{}
  1 & -1 & 1 \\
  -1 & -1 & 3 \\
  -1 & 2 & -1
\end{array}
\right)
$$

Пусть первый игрок придерживается следующей смешанной стратегии $(\frac{6}{13}, \frac{3}{13}, \frac{4}{13}$, а второй $(\frac{6}{13}, \frac{4}{13}, \frac{3}{13})$. Вычислить математическое ожидание проигрыша первого игрока.

### Решение

Для того, чтобы найти матиматическое ожидание проигрыша первого игрока, нужно смешанную стратегию первого игрока умножить на платёжную матрицу, а затем полученную матрицу умножить на транспонированную смешанную стратегию второго игрока.

$$
(\frac{6}{13}, \frac{3}{13}, \frac{4}{13}) \cdot
\left(
\begin{array}{}
  1 & -1 & 1 \\
  -1 & -1 & 3 \\
  -1 & 2 & -1
\end{array}
\right) \cdot
(\frac{6}{13}, \frac{4}{13}, \frac{3}{13})^T
$$

В результате получаем число  $-\frac{1}{13}$, то есть математическое ожидание проигрыша первого игрока равно $-\frac{1}{13}$.

## **Задание 8**

Задача линейного программирования:

$$
x_1 + x_2 \rightarrow min
$$

$$
\begin{cases}
  7x_1 + 2x_2 \ge 1 \\
  x_1 + 11x_2 \ge 1 \\
  x_j \ge 0, \quad (j = 1, 2)
\end{cases}
$$

От этой задачи можно перейти к матричной игре, с матрицей проигрышей первого игрока:

$$
\left(
  \begin{array}{l}
    7 \quad 2 \\
    1 \quad 11 \\
  \end{array}
\right)
$$

Данная матричная игра не имеет седловой точки, поэтому не может быть решена в чистых стратегиях. Найдём оптимальные смешанные стратегии для матрицы размером 2x2.

Учитывая то, что первый игрок минимизирует убыток, формула для его смешанной стратегии следующая:

$$
\left(
  \frac{a_{22} - a_{12}}{a_{22} - a_{12} + a_{11} - a_{21}},
  \frac{a_{11} - a_{21}}{a_{22} - a{12} + a_{11} - a_{21}}
\right)
$$

Подставим значения из задачи и решим.

$$
\left(
  \frac{11 - 2}{11 - 2 + 7 - 1},
  \frac{7 - 1}{11 - 2 + 7 - 1}
\right) =
\left(
  \frac{9}{15},
  \frac{6}{15}
\right)
$$

**Оптимальная смешанная стратегия первого игрока:**

$$
\bold{\left(
  \frac{3}{5},
  \frac{2}{5}
\right)}
$$

Формула для оптимальной стратегии второго игрока:

$$
\left(
  \frac{a_{22} - a_{21}}{a_{22} - a_{12} + a_{11} - a_{21}},
  \frac{a_{11} - a_{12}}{a_{22} - a{12} + a_{11} - a_{21}}
\right)
$$

Подставим значения из задачи и решим.

$$
\left(
  \frac{11 - 1}{11 - 2 + 7 - 1},
  \frac{7 - 2}{11 - 2 + 7 - 1}
\right) =
\left(
  \frac{10}{15},
  \frac{5}{15}
\right)
$$

**Оптимальная смешанная стратегия второго игрока:**

$$
\bold{\left(
  \frac{2}{3},
  \frac{1}{3}
\right)}
$$

Формула для цены игры:

$$
\frac{a_{22} a_{11} - a_{12} a_{21}}{a_{11} + a_{22} - a_{12} - a_{21}}
$$

Подставим значения из задачи и решим.

$$
\frac{11 \cdot 7 - 2 \cdot 1}{7 + 11 - 2 - 1} = \frac{75}{15}
$$

**Цена игры равна $\bold{5}$**

Найдём математическое ожидание, как произведение стратегии первого игрока на матрицу игры и на транспонированную стратегию второго игрока:

$$
\left(
  \frac{3}{5} \quad
  \frac{2}{5}
\right) \cdot
\left(
  \begin{array}{l}
    7 \quad 2 \\
    1 \quad 11 \\
  \end{array}
\right) \cdot
\left(
  \begin{array}{}
    \frac{3}{5} \\ \\
    \frac{2}{5}
  \end{array}
\right) =
\left(
  \frac{23}{5} \quad
  \frac{28}{5}
\right) \cdot
\left(
  \begin{array}{}
    \frac{3}{5} \\ \\
    \frac{2}{5}
  \end{array}
\right) = 5
$$

**Математическое ожидание проигрыша первого игрока равно $\bold{5}$.**

## **Задание 9**

### Условие

Перейти от следующей задачи линейного программирования $L(x)=x_1+x_2+x_3+x_4\to\max$

$$
\begin{cases}
  7x_1 + 2x_2 + 5x_3 + x_4 \leq 1 \\
  2x_1 + 2x_2 + 3x_3 + 4x_4 \leq 1 \\
  5x_1 + 3x_2 + 4x_3 + 4x_4 \leq 1 \\
  3x_1 + 2x_2 + x_3 + 6x_4 \leq 1 \\
  x_j \ge 0, \quad j=1, 2, 3, 4
\end{cases}
$$

к матричной игре. Можно ли упростить матричную игру, используя понятие доминирования стратеий? Решить матричную игру любым известным вам способом. 

### Решение

Перейдём от задачи линейного программирования к матричной игре. Тогда платёжная матрица будет иметь вид

$$
\left(
  \begin{array}{}
    7 & 2 & 5 & 1 \\
    2 & 2 & 3 & 4 \\
    5 & 3 & 4 & 4 \\
    3 & 2 & 1 & 6
  \end{array}
\right)
$$

Воспользуемся понятием доминирования стратегий. Можно заметить, что при выборе вторым игроком первой стратегии результат всегда будет не лучше, чем при выборе второй стратегии - то есть для второго игрока вторая стратегия доминирует первую. Таким образом, можно упростить матричную игру, удалив первую стратегию второго игрока. Тогда платёжная матрица будет иметь вид. 

$$
\left(
  \begin{array}{}
    2 & 5 & 1 \\
    2 & 3 & 4 \\
    3 & 4 & 4 \\
    2 & 1 & 6
  \end{array}
\right)
$$

Теперь видно что при выборе первым игротом второй стратегии результат всегда будет не лучше, чем при выборе третьей стратегии - то есть для первого игрока третья стратегия доминирует вторую. Таким образом, можно упростить матричную игру, удалив вторую стратегию первого игрока. Тогда платёжная матрица будет иметь вид.

$$
\left(
  \begin{array}{}
    2 & 5 & 1 \\
    3 & 4 & 4 \\
    2 & 1 & 6
  \end{array}
\right)
$$

Решим упрощенную версию матричной игры с помощью метода минмакса. Справа от платёжной матрицы выпишем наименьшие элементы в её строках и отметим максимальный из них, а снизу от матрицы - наибольшие элементы в столбцах и выберем минимальный из них.

$$
\left(
  \begin{array}{}
    2 & 5 & 1 \\
    3 & 4 & 4 \\
    2 & 1 & 6
  \end{array}
\right)
\begin{array}{}
1 \\
[3] \\
1
\end{array}
\\
\begin{array}{}
  [3] & 4 & 4 &&
\end{array}
$$

Таким образом нижняя и верхняя цена игры равна 3, то есть игра имеет седловую точку и решение в чистых стратегиях. Первый игрок выбирает третью стратегию, а второй - вторую.
